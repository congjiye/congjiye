(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{538:function(a,s,e){"use strict";e.r(s);var t=e(3),r=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("p",[a._v("Windows 环境下使用 FFmpeg 推送本地 USB 摄像头为 rtsp 流，并使用 vlc 播放。\n")]),a._v(" "),e("p",[a._v("本文主要使用环境是 Windows 下的 FFmpeg 推送本地摄像头为 rtsp 流。")]),a._v(" "),e("h2",{attrs:{id:"下载-ffmpeg"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下载-ffmpeg"}},[a._v("#")]),a._v(" 下载 FFmpeg")]),a._v(" "),e("p",[e("a",{attrs:{href:"https://ffmpeg.org/download.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("FFmpeg官网"),e("OutboundLink")],1),a._v(" 下载 Windows 版本的 FFmpeg，并把 FFmpeg 的 bin 目录加入到环境变量中。")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/aydon/drawing-bed/raw/master/img/image-20210119145723604.png",alt:"image-20210119145723604"}})]),a._v(" "),e("p",[a._v("右键此电脑选择 高级系统设置 -> 环境变量 -> Path -> 添加环境变量")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/aydon/drawing-bed/raw/master/img/image-20210119150223038.png",alt:"image-20210119150223038"}})]),a._v(" "),e("p",[a._v("添加完环境变量后在终端内执行显示如下内容证明 ffmpeg 安装成功。")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("ffmpeg -version\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://gitee.com/aydon/drawing-bed/raw/master/img/image-20210119150441613.png",alt:"image-20210119150441613"}})]),a._v(" "),e("h2",{attrs:{id:"下载-easydarwin"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下载-easydarwin"}},[a._v("#")]),a._v(" 下载 EasyDarwin")]),a._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/EasyDarwin/EasyDarwin/releases",target:"_blank",rel:"noopener noreferrer"}},[a._v("EasyDarwin 下载地址"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/aydon/drawing-bed/raw/master/img/image-20210119150933153.png",alt:"image-20210119150933153"}})]),a._v(" "),e("p",[a._v("下载解压到本地后运行 EasyDarwin.exe 程序。点击运行后会弹出一个 cmd 命令框，在浏览器中输入 http://127.0.0.1:10008 查看是否有显示有个 web 页面，如果显示则证明打开成功。"),e("strong",[a._v("注：不要关闭弹出的命令框")])]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/aydon/drawing-bed/raw/master/img/image-20210119151012772.png",alt:"image-20210119151012772"}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/aydon/drawing-bed/raw/master/img/image-20210119151108504.png",alt:"image-20210119151108504"}})]),a._v(" "),e("h2",{attrs:{id:"使用-ffmpeg-获取-directshow-设备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用-ffmpeg-获取-directshow-设备"}},[a._v("#")]),a._v(" 使用 FFmpeg 获取 DirectShow 设备")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("ffmpeg -list_devices "),e("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v(" -f dshow -i dummy\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://gitee.com/aydon/drawing-bed/raw/master/img/image-20210119140142043.png",alt:"image-20210119140142043"}})]),a._v(" "),e("h3",{attrs:{id:"获取摄像头信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取摄像头信息"}},[a._v("#")]),a._v(" 获取摄像头信息")]),a._v(" "),e("h4",{attrs:{id:"编码为-h-264-保存为本地文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编码为-h-264-保存为本地文件"}},[a._v("#")]),a._v(" 编码为 H.264 保存为本地文件")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("ffmpeg -f dshow -i "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("video")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Logitech Webcam C930e"')]),a._v(" -vcodec libx264 mycamera.mkv\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h4",{attrs:{id:"直接播放摄像头数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#直接播放摄像头数据"}},[a._v("#")]),a._v(" 直接播放摄像头数据")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("ffplay -f dshow -i "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("video")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Logitech Webcam C930e"')]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("或是使用 VFW 也可以读取摄像头数据")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("ffplay -f vfwcap -i "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("此外可以使用 FFmpeg 的 list_options 查看设备的选项")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("ffmpeg -list_options "),e("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v(" -f dshow -i "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("video")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Logitech Webcam C930e"')]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h3",{attrs:{id:"推送摄像头到-rtsp-服务器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#推送摄像头到-rtsp-服务器"}},[a._v("#")]),a._v(" 推送摄像头到 rtsp 服务器")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("ffmpeg -f dshow -i "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("video")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Logitech Webcam C930e"')]),a._v(" -vcodec libx264 -preset:v ultrafast -tune:v zerolatency -rtsp_transport tcp -f rtsp rtsp://127.0.0.1/test\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("运行后可以在上方打开的 EasyDarwin 的 web 页面中的推流列表中查看是否有 rtsp 流的地址。")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/aydon/drawing-bed/raw/master/img/image-20210119151409126.png",alt:"image-20210119151409126"}})]),a._v(" "),e("h4",{attrs:{id:"使用-vlc-打开-rtsp-流"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用-vlc-打开-rtsp-流"}},[a._v("#")]),a._v(" 使用 vlc 打开 rtsp 流")]),a._v(" "),e("p",[a._v("选中媒体，点击打开网络串流")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/aydon/drawing-bed/raw/master/img/image-20210119151521149.png",alt:"image-20210119151521149"}})]),a._v(" "),e("p",[a._v("选择网络，在 URL 中输入之前页面中的 rtsp 地址，成功则播放 rtsp 流内容。")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/aydon/drawing-bed/raw/master/img/image-20210119151604563.png",alt:"image-20210119151604563"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);