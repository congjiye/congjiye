(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{537:function(e,a,s){"use strict";s.r(a);var t=s(3),r=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("Windows 环境下使用 FFmpeg 推送本地 USB 摄像头为 rtsp 流，并使用 vlc 播放。\n")]),e._v(" "),s("p",[e._v("本文主要使用环境是 Windows 下的 FFmpeg 推送本地摄像头为 rtsp 流。")]),e._v(" "),s("h2",{attrs:{id:"下载-ffmpeg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载-ffmpeg"}},[e._v("#")]),e._v(" 下载 FFmpeg")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://ffmpeg.org/download.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("FFmpeg官网"),s("OutboundLink")],1),e._v(" 下载 Windows 版本的 FFmpeg，并把 FFmpeg 的 bin 目录加入到环境变量中。")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/congjiye/drawing-bed/raw/master/img/image-20210119145723604.png",alt:"image-20210119145723604"}})]),e._v(" "),s("p",[e._v("右键此电脑选择 高级系统设置 -> 环境变量 -> Path -> 添加环境变量")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/congjiye/drawing-bed/raw/master/img/image-20210119150223038.png",alt:"image-20210119150223038"}})]),e._v(" "),s("p",[e._v("添加完环境变量后在终端内执行显示如下内容证明 ffmpeg 安装成功。")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ffmpeg -version\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://gitee.com/congjiye/drawing-bed/raw/master/img/image-20210119150441613.png",alt:"image-20210119150441613"}})]),e._v(" "),s("h2",{attrs:{id:"下载-easydarwin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载-easydarwin"}},[e._v("#")]),e._v(" 下载 EasyDarwin")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/EasyDarwin/EasyDarwin/releases",target:"_blank",rel:"noopener noreferrer"}},[e._v("EasyDarwin 下载地址"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/congjiye/drawing-bed/raw/master/img/image-20210119150933153.png",alt:"image-20210119150933153"}})]),e._v(" "),s("p",[e._v("下载解压到本地后运行 EasyDarwin.exe 程序。点击运行后会弹出一个 cmd 命令框，在浏览器中输入 http://127.0.0.1:10008 查看是否有显示有个 web 页面，如果显示则证明打开成功。"),s("strong",[e._v("注：不要关闭弹出的命令框")])]),e._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/congjiye/drawing-bed/raw/master/img/image-20210119151012772.png",alt:"image-20210119151012772"}})]),e._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/congjiye/drawing-bed/raw/master/img/image-20210119151108504.png",alt:"image-20210119151108504"}})]),e._v(" "),s("h2",{attrs:{id:"使用-ffmpeg-获取-directshow-设备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-ffmpeg-获取-directshow-设备"}},[e._v("#")]),e._v(" 使用 FFmpeg 获取 DirectShow 设备")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ffmpeg -list_devices "),s("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v(" -f dshow -i dummy\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://gitee.com/congjiye/drawing-bed/raw/master/img/image-20210119140142043.png",alt:"image-20210119140142043"}})]),e._v(" "),s("h3",{attrs:{id:"获取摄像头信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取摄像头信息"}},[e._v("#")]),e._v(" 获取摄像头信息")]),e._v(" "),s("h4",{attrs:{id:"编码为-h-264-保存为本地文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编码为-h-264-保存为本地文件"}},[e._v("#")]),e._v(" 编码为 H.264 保存为本地文件")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ffmpeg -f dshow -i "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("video")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Logitech Webcam C930e"')]),e._v(" -vcodec libx264 mycamera.mkv\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"直接播放摄像头数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#直接播放摄像头数据"}},[e._v("#")]),e._v(" 直接播放摄像头数据")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ffplay -f dshow -i "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("video")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Logitech Webcam C930e"')]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("或是使用 VFW 也可以读取摄像头数据")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ffplay -f vfwcap -i "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("此外可以使用 FFmpeg 的 list_options 查看设备的选项")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ffmpeg -list_options "),s("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v(" -f dshow -i "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("video")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Logitech Webcam C930e"')]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"推送摄像头到-rtsp-服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#推送摄像头到-rtsp-服务器"}},[e._v("#")]),e._v(" 推送摄像头到 rtsp 服务器")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ffmpeg -f dshow -i "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("video")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Logitech Webcam C930e"')]),e._v(" -vcodec libx264 -preset:v ultrafast -tune:v zerolatency -rtsp_transport tcp -f rtsp rtsp://127.0.0.1/test\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("运行后可以在上方打开的 EasyDarwin 的 web 页面中的推流列表中查看是否有 rtsp 流的地址。")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/congjiye/drawing-bed/raw/master/img/image-20210119151409126.png",alt:"image-20210119151409126"}})]),e._v(" "),s("h4",{attrs:{id:"使用-vlc-打开-rtsp-流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-vlc-打开-rtsp-流"}},[e._v("#")]),e._v(" 使用 vlc 打开 rtsp 流")]),e._v(" "),s("p",[e._v("选中媒体，点击打开网络串流")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/congjiye/drawing-bed/raw/master/img/image-20210119151521149.png",alt:"image-20210119151521149"}})]),e._v(" "),s("p",[e._v("选择网络，在 URL 中输入之前页面中的 rtsp 地址，成功则播放 rtsp 流内容。")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/congjiye/drawing-bed/raw/master/img/image-20210119151604563.png",alt:"image-20210119151604563"}})])])}),[],!1,null,null,null);a.default=r.exports}}]);